!function(a,b){"function"==typeof define&&define.amd?define(["underscore","jquery","transform","backbone.marionette"],b):"object"==typeof exports?module.exports=b(require("underscore"),require("jquery"),require("transform"),require("backbone.marionette")):a.transform=b(a._,a.$,a.transform,a.Marionette)}(this,function(a,b,c,d){var e,f,g=a,h=b,i=d;return e=function(){"use strict";var a={},b=g;return a.WrongArgumentsError=function(){this.message="Wrong arguments. Required argument `options` must be an  Object. Required argument `callback` must be a Function."},a.InvalidRootElementError=function(a){this.message='Invalid root element. options.$el must match the following selector: "'+a+'".'},a.MissingElementError=function(){this.message="Required option `$el` is missing."},a.MissingConfigurationError=function(a){this.message='Global configuration object for key "'+a+'" not found.'},a.MissingDefinitionError=function(){this.message="Missing definition string for some modules."},a.FailedToLoadDefinitionError=function(a){this.message="Some definitions failed to load.\n"+a.message},b.each(a,function(a){a.prototype=new Error}),a}(),f=function(a){"use strict";function b(a,b){var c,e,g,h;if(!q.isObject(a)||!q.isFunction(b))throw new t.WrongArgumentsError;return a.$el?v(a.$el).isValid()?q.isString(a.configKey)&&q.isUndefined(window[a.configKey])?b(new t.MissingConfigurationError(a.configKey)):(c=p(a.configKey),g=q.partial(o,c),e=q.chain(k(z(a.$el),[])).reduce(g,[]).value(),h=q.chain(e).pluck("definition").uniq().value(),j(h)?b(new t.MissingDefinitionError):void f(h,function(){b(null,d(e))},function(a){b(new t.FailedToLoadDefinitionError(a))})):b(new t.InvalidRootElementError(v.selector())):b(new t.MissingElementError)}function d(b){var c=new u.Application,d={};return q.each(b,function(b){d[b.shortName]=b.data,c.module(b.name,a(b.definition))}),{app:c,options:d}}function f(){}function j(a){return q.some(a,function(a){return!a})}function k(a,b){var c=b.concat(a);return q.reduce(a.children,function(a,b){return a.concat(k(b,c))},[c])}function l(a){return r(a.el).attr("data-name")||q.uniqueId("unnamed-")}function m(a){return w(a.el).value()||void 0}function n(a){return q.reduce(a,function(a,b){return a.concat(l(b))},[]).join(".")}function o(a,b,c){var d;return 1===c.length?b:(d=q.last(c),d.name=n(c.slice(1)),d.data=a(l(d)),d.shortName=l(d),d.definition=m(d),b.concat(d))}function p(a){var b=window[a]||{};return function(a){return b[a]||{}}}var q=g,r=h,s=c,t=e,u=i,v=s.selector("app"),w=s.selector("module"),x=s.rule(v,[w]),y=s.rule(w,[w]),z=s([x,y]);return q.each(t,function(a,c){b[c]=a}),b}({}),f.VERSION="0.0.0",f});
//# sourceMappingURL=modular.min.js.map